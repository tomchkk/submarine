#!/usr/bin/env bash

source "$SERVICE/autoload-service"
source "$SERVICE/submodule-service"

##
# Requires a new git repo as a submodule for a project.
##
require_feature::require() {
    local is_dev="${1:-false}"
    local version="${2:-false}"
    local arguments="${@:3}"

    submodule_service::add true "$is_dev" "$version" "$arguments"

    if [[ $? -eq 0 ]]; then
        autoload_service::refresh
    fi
}

##
# Parses a submodule name from the git ssh repo address - i.e.:
# - git@gitlab.com:vendor/project.git -> vendor/project
##
require_feature::parse_name_from_repo() {
    local name=${1:?"A repo value is required"}

    echo ${name/.git/} | cut -d ':' -f 2
}
